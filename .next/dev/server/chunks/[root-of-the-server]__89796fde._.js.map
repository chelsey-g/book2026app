{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/chelseygowac/book-tracker-app/src/lib/data-sources/book-sources.ts"],"sourcesContent":["import axios from 'axios';\n\nexport async function searchBooksOpenLibrary(query: string, limit = 20) {\n  try {\n    const response = await axios.get(`https://openlibrary.org/search.json?q=${encodeURIComponent(query)}&limit=${limit}`);\n    return response.data.docs.map((book: any) => ({\n      title: book.title,\n      author: book.author_name?.[0] || 'Unknown Author',\n      isbn: book.isbn?.[0],\n      coverUrl: book.cover_i ? `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg` : null,\n      publishedDate: book.first_publish_year,\n      pageCount: book.number_of_pages_median,\n      description: null, // Open Library doesn't typically provide descriptions\n    }));\n  } catch (error) {\n    console.error('Open Library search error:', error);\n    return [];\n  }\n}\n\nexport async function searchBooksGoogleAI(query: string, limit = 20) {\n  try {\n    const response = await axios.get(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}&maxResults=${limit}`);\n    return response.data.items.map((book: any) => ({\n      title: book.volumeInfo.title,\n      author: book.volumeInfo.authors?.[0] || 'Unknown Author',\n      isbn: book.volumeInfo.industryIdentifiers?.find((id: any) => id.type === 'ISBN_13')?.identifier,\n      coverUrl: book.volumeInfo.imageLinks?.thumbnail,\n      publishedDate: book.volumeInfo.publishedDate,\n      pageCount: book.volumeInfo.pageCount,\n      description: book.volumeInfo.description,\n    }));\n  } catch (error) {\n    console.error('Google Books search error:', error);\n    return [];\n  }\n}\n\nexport async function searchBooks(query: string, limit = 20) {\n  const openLibraryResults = await searchBooksOpenLibrary(query, limit);\n  \n  if (openLibraryResults.length > 0) {\n    return openLibraryResults;\n  }\n  \n  return searchBooksGoogleAI(query, limit);\n}"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe,uBAAuB,KAAa,EAAE,QAAQ,EAAE;IACpE,IAAI;QACF,MAAM,WAAW,MAAM,4KAAK,CAAC,GAAG,CAAC,CAAC,sCAAsC,EAAE,mBAAmB,OAAO,OAAO,EAAE,OAAO;QACpH,OAAO,SAAS,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAc,CAAC;gBAC5C,OAAO,KAAK,KAAK;gBACjB,QAAQ,KAAK,WAAW,EAAE,CAAC,EAAE,IAAI;gBACjC,MAAM,KAAK,IAAI,EAAE,CAAC,EAAE;gBACpB,UAAU,KAAK,OAAO,GAAG,CAAC,oCAAoC,EAAE,KAAK,OAAO,CAAC,MAAM,CAAC,GAAG;gBACvF,eAAe,KAAK,kBAAkB;gBACtC,WAAW,KAAK,sBAAsB;gBACtC,aAAa;YACf,CAAC;IACH,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,EAAE;IACX;AACF;AAEO,eAAe,oBAAoB,KAAa,EAAE,QAAQ,EAAE;IACjE,IAAI;QACF,MAAM,WAAW,MAAM,4KAAK,CAAC,GAAG,CAAC,CAAC,8CAA8C,EAAE,mBAAmB,OAAO,YAAY,EAAE,OAAO;QACjI,OAAO,SAAS,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAc,CAAC;gBAC7C,OAAO,KAAK,UAAU,CAAC,KAAK;gBAC5B,QAAQ,KAAK,UAAU,CAAC,OAAO,EAAE,CAAC,EAAE,IAAI;gBACxC,MAAM,KAAK,UAAU,CAAC,mBAAmB,EAAE,KAAK,CAAC,KAAY,GAAG,IAAI,KAAK,YAAY;gBACrF,UAAU,KAAK,UAAU,CAAC,UAAU,EAAE;gBACtC,eAAe,KAAK,UAAU,CAAC,aAAa;gBAC5C,WAAW,KAAK,UAAU,CAAC,SAAS;gBACpC,aAAa,KAAK,UAAU,CAAC,WAAW;YAC1C,CAAC;IACH,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,EAAE;IACX;AACF;AAEO,eAAe,YAAY,KAAa,EAAE,QAAQ,EAAE;IACzD,MAAM,qBAAqB,MAAM,uBAAuB,OAAO;IAE/D,IAAI,mBAAmB,MAAM,GAAG,GAAG;QACjC,OAAO;IACT;IAEA,OAAO,oBAAoB,OAAO;AACpC"}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///Users/chelseygowac/book-tracker-app/src/app/api/books/popular/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\nimport { searchBooks } from '@/lib/data-sources/book-sources';\n\nexport async function GET(request: NextRequest) {\n  const { searchParams } = request.nextUrl;\n  const limit = parseInt(searchParams.get('limit') || '20');\n  const genre = searchParams.get('genre');\n  const timeframe = searchParams.get('timeframe') || 'all';\n\n  const supabase = createClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n  );\n\n  try {\n    let dateFilter = '';\n    const now = new Date();\n    \n    if (timeframe === 'week') {\n      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString();\n      dateFilter = `and created_at > '${weekAgo}'`;\n    } else if (timeframe === 'month') {\n      const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000).toISOString();\n      dateFilter = `and created_at > '${monthAgo}'`;\n    }\n\n    const { data: books, error } = await supabase\n      .from('books')\n      .select(`\n        *,\n        reviews:reviews(count),\n        user_books:user_books(count)\n      `)\n      .gt('view_count', 0)\n      .order('view_count', { ascending: false })\n      .limit(limit);\n\n    if (error) throw error;\n\n    const booksWithScores = (books || []).map((book: any) => {\n      const reviewCount = book.reviews?.[0]?.count || 0;\n      const userCount = book.user_books?.[0]?.count || 0;\n      const viewCount = book.view_count || 0;\n      \n      const trendingScore = (viewCount * 0.3) + (reviewCount * 0.4) + (userCount * 0.3);\n\n      return {\n        ...book,\n        trendingScore,\n        reviewCount,\n        userCount,\n      };\n    }).sort((a: any, b: any) => b.trendingScore - a.trendingScore);\n\n    return NextResponse.json({ books: booksWithScores });\n  } catch (error) {\n    console.error('Popular books error:', error);\n    try {\n      let query = 'popular';\n      if (genre) {\n        query += ` ${genre}`;\n      }\n      \n      const fallbackBooks = await searchBooks(query, limit);\n      return NextResponse.json({ books: fallbackBooks });\n    } catch (fallbackError) {\n      console.error('Fallback error:', fallbackError);\n      return NextResponse.json(\n        { error: 'Failed to fetch trending books' },\n        { status: 500 }\n      );\n    }\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,EAAE,YAAY,EAAE,GAAG,QAAQ,OAAO;IACxC,MAAM,QAAQ,SAAS,aAAa,GAAG,CAAC,YAAY;IACpD,MAAM,QAAQ,aAAa,GAAG,CAAC;IAC/B,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB;IAEnD,MAAM,WAAW,IAAA,0NAAY;IAK7B,IAAI;QACF,IAAI,aAAa;QACjB,MAAM,MAAM,IAAI;QAEhB,IAAI,cAAc,QAAQ;YACxB,MAAM,UAAU,IAAI,KAAK,IAAI,OAAO,KAAK,IAAI,KAAK,KAAK,KAAK,MAAM,WAAW;YAC7E,aAAa,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;QAC9C,OAAO,IAAI,cAAc,SAAS;YAChC,MAAM,WAAW,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,WAAW;YAC/E,aAAa,CAAC,kBAAkB,EAAE,SAAS,CAAC,CAAC;QAC/C;QAEA,MAAM,EAAE,MAAM,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,SACL,MAAM,CAAC,CAAC;;;;MAIT,CAAC,EACA,EAAE,CAAC,cAAc,GACjB,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM,GACvC,KAAK,CAAC;QAET,IAAI,OAAO,MAAM;QAEjB,MAAM,kBAAkB,CAAC,SAAS,EAAE,EAAE,GAAG,CAAC,CAAC;YACzC,MAAM,cAAc,KAAK,OAAO,EAAE,CAAC,EAAE,EAAE,SAAS;YAChD,MAAM,YAAY,KAAK,UAAU,EAAE,CAAC,EAAE,EAAE,SAAS;YACjD,MAAM,YAAY,KAAK,UAAU,IAAI;YAErC,MAAM,gBAAgB,AAAC,YAAY,MAAQ,cAAc,MAAQ,YAAY;YAE7E,OAAO;gBACL,GAAG,IAAI;gBACP;gBACA;gBACA;YACF;QACF,GAAG,IAAI,CAAC,CAAC,GAAQ,IAAW,EAAE,aAAa,GAAG,EAAE,aAAa;QAE7D,OAAO,0KAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB;IACpD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,IAAI;YACF,IAAI,QAAQ;YACZ,IAAI,OAAO;gBACT,SAAS,CAAC,CAAC,EAAE,OAAO;YACtB;YAEA,MAAM,gBAAgB,MAAM,IAAA,2LAAW,EAAC,OAAO;YAC/C,OAAO,0KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAc;QAClD,EAAE,OAAO,eAAe;YACtB,QAAQ,KAAK,CAAC,mBAAmB;YACjC,OAAO,0KAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAiC,GAC1C;gBAAE,QAAQ;YAAI;QAElB;IACF;AACF"}}]
}