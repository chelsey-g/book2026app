{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/chelseygowac/book-tracker-app/src/app/profile/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { supabase } from '@/lib/supabase/client';\nimport Link from 'next/link';\nimport { FiBook, FiStar, FiUsers, FiSettings, FiEdit2, FiCamera, FiUpload } from 'react-icons/fi';\nimport { Target } from 'lucide-react';\n\ninterface UserProfile {\n  id: string;\n  username: string;\n  name: string;\n  bio: string;\n  created_at: string;\n}\n\ninterface UserBook {\n  id: string;\n  books?: {\n    title: string;\n    author: string;\n    cover_url: string;\n  };\n  status: string;\n  rating?: number;\n  completed_at?: string;\n}\n\ninterface ReadingGoal {\n  id: string;\n  user_id: string;\n  year: number;\n  goal_count: number;\n  created_at: string;\n}\n\nexport default function ProfilePage() {\n  const { user } = useAuth();\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [userBooks, setUserBooks] = useState<UserBook[]>([]);\n  const [readingGoal, setReadingGoal] = useState<ReadingGoal | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editBio, setEditBio] = useState('');\n  const [isEditingGoal, setIsEditingGoal] = useState(false);\n  const [editGoalCount, setEditGoalCount] = useState(12);\n  const [uploadingPicture, setUploadingPicture] = useState(false);\n  const [profilePictureUrl, setProfilePictureUrl] = useState<string | null>(null);\n\n  const fetchProfile = useCallback(async () => {\n    try {\n      const { data, error } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', user?.id)\n        .single();\n\n       if (data && !error) {\n         console.log('Profile fetched:', data);\n         console.log('Image URL:', data.image);\n         setProfile(data);\n         setEditBio(data.bio || '');\n         setProfilePictureUrl(data.image || null);\n      } else {\n        console.error('User profile not found:', error);\n      }\n    } catch (error) {\n      console.error('Error fetching profile:', error);\n    }\n  }, [user?.id]);\n\n  useEffect(() => {\n    if (user) {\n      fetchProfile();\n      fetchUserBooks();\n      fetchReadingGoal();\n    }\n  }, [user, fetchProfile]);\n\n  const fetchUserBooks = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('user_books')\n        .select('*, books(*)')\n        .eq('user_id', user?.id)\n        .order('updated_at', { ascending: false });\n\n      if (data && !error) {\n        setUserBooks(data as any);\n      }\n    } catch (error) {\n      console.error('Error fetching user books:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchReadingGoal = async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) return;\n\n      const response = await fetch('/api/reading-goals', {\n        headers: {\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n      });\n\n      const data = await response.json();\n      if (data.goal) {\n        setReadingGoal(data.goal);\n        setEditGoalCount(data.goal.goal_count);\n      }\n    } catch (error) {\n      console.error('Error fetching reading goal:', error);\n    }\n  };\n\n  const updateBio = async () => {\n    try {\n      const { error } = await supabase\n        .from('users')\n        .update({ bio: editBio })\n        .eq('id', user?.id);\n\n      if (!error) {\n        setProfile(prev => prev ? { ...prev, bio: editBio } : null);\n        setIsEditing(false);\n      } else {\n        console.error('Error updating bio:', error);\n      }\n    } catch (error) {\n      console.error('Error updating bio:', error);\n    }\n  };\n\n  const updateReadingGoal = async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        console.error('No session token available');\n        return;\n      }\n\n      const response = await fetch('/api/reading-goals', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({\n          goal_count: editGoalCount,\n          year: new Date().getFullYear(),\n        }),\n      });\n\n      const data = await response.json();\n      \n      if (!response.ok) {\n        console.error('API Error:', data.error || 'Unknown error');\n        alert('Error saving goal: ' + (data.error || 'Unknown error'));\n        return;\n      }\n\n      if (data.goal) {\n        setReadingGoal(data.goal);\n        setIsEditingGoal(false);\n        console.log('Goal saved successfully:', data.goal);\n      } else {\n        console.error('No goal in response:', data);\n        alert('Failed to save goal - no data returned');\n      }\n    } catch (error) {\n      console.error('Error updating reading goal:', error);\n      alert('Error saving goal: ' + String(error));\n    }\n  };\n\n  const getBooksByStatus = (status: string) => {\n    return userBooks.filter(book => book.status === status);\n  };\n\n  const booksReadThisYear = getBooksByStatus('READ').filter(book => {\n    if (!book.completed_at) return false;\n    const completedYear = new Date(book.completed_at).getFullYear();\n    const currentYear = new Date().getFullYear();\n    return completedYear === currentYear;\n  }).length;\n\n\n  const handleProfilePictureUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    console.log('File input changed, files:', event.target.files);\n    const file = event.target.files?.[0];\n    if (!file) {\n      console.log('No file selected');\n      return;\n    }\n\n    console.log('File selected:', file.name, file.type, file.size);\n\n    // Validate file type\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];\n    if (!allowedTypes.includes(file.type)) {\n      alert('Invalid file type. Only JPEG, PNG, GIF, and WebP are allowed.');\n      return;\n    }\n\n    // Validate file size (max 5MB)\n    const maxSize = 5 * 1024 * 1024; // 5MB\n    if (file.size > maxSize) {\n      alert('File too large. Maximum size is 5MB.');\n      return;\n    }\n\n    setUploadingPicture(true);\n    console.log('Starting upload...');\n\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        alert('Authentication required. Please sign in again.');\n        return;\n      }\n\n      const formData = new FormData();\n      formData.append('profilePicture', file);\n\n      console.log('FormData created with file:', file);\n      console.log('FormData has profilePicture:', formData.has('profilePicture'));\n\n      console.log('Sending request to /api/profile-picture...');\n      const response = await fetch('/api/profile-picture', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: formData,\n      });\n\n      console.log('Response status:', response.status);\n      const data = await response.json();\n      console.log('Response data:', data);\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Upload failed');\n      }\n\n       if (data.success) {\n         console.log('Upload successful, new URL:', data.profilePictureUrl);\n\n         setProfilePictureUrl(data.profilePictureUrl);\n         setProfile(prev => prev ? { ...prev, image: data.profilePictureUrl } : null);\n\n         // Fetch profile immediately to get updated data\n         await fetchProfile();\n         alert('Profile picture updated successfully!');\n       }\n    } catch (error) {\n      console.error('Upload error:', error);\n      alert('Failed to upload profile picture: ' + String(error));\n    } finally {\n      setUploadingPicture(false);\n      // Reset the file input\n      event.target.value = '';\n    }\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Please sign in to view your profile</h1>\n          <Link href=\"/auth/signin\" className=\"text-blue-600 hover:text-blue-800\">\n            Sign In\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-lg\">Loading profile...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30\">\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden mb-6\">\n          <div className=\"h-24 bg-gradient-to-r from-teal-500 to-emerald-500\"></div>\n          \n          <div className=\"px-8 pb-8\">\n            <div className=\"flex items-start gap-6 -mt-16 mb-6\">\n              <div className=\"relative\" style={{ width: '128px', height: '128px' }}>\n                    {profilePictureUrl ? (\n                      <img\n                        src={profilePictureUrl}\n                        alt=\"Profile\"\n                        className=\"h-32 w-32 object-cover rounded-full border-4 border-white shadow-lg\"\n                      />\n                    ) : (\n                      <img\n                        src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='128' height='128'%3E%3Ccircle cx='64' cy='64' r='64' fill='%23e5e7eb'/%3E%3C/svg%3E\"\n                        alt=\"Profile\"\n                        className=\"h-32 w-32 object-cover rounded-full border-4 border-white shadow-lg\"\n                      />\n                    )}\n                    <label \n                      htmlFor=\"avatar-upload\" \n                      className=\"absolute bottom-0 right-0 bg-teal-600 hover:bg-teal-700 text-white rounded-full p-2 cursor-pointer shadow-lg transition-colors\"\n                      title=\"Upload avatar\"\n                    >\n                      {uploadingPicture ? (\n                        <FiUpload className=\"w-5 h-5 animate-pulse\" />\n                      ) : (\n                        <FiCamera className=\"w-5 h-5\" />\n                      )}\n                    </label>\n                    <input\n                      id=\"avatar-upload\"\n                      type=\"file\"\n                      accept=\"image/jpeg,image/png,image/gif,image/webp\"\n                      onChange={handleProfilePictureUpload}\n                      className=\"hidden\"\n                      disabled={uploadingPicture}\n                    />\n              </div>\n\n              <div className=\"flex-1 mt-16\">\n                <h1 className=\"text-3xl font-bold text-gray-900 mb-1\">\n                  {profile?.name || user.user_metadata?.full_name || user.user_metadata?.name || user.email?.split('@')[0] || 'User'}\n                </h1>\n                <p className=\"text-gray-500 mb-1\">@{user.user_metadata?.username || profile?.username || user.email?.split('@')[0] || 'user'}</p>\n                <p className=\"text-sm text-gray-400 flex items-center gap-1\">\n                  <FiUsers className=\"w-4 h-4\" />\n                  Member since {new Date(user.created_at || profile?.created_at || '').toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-4 mb-6\">\n              <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-100\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <FiBook className=\"w-5 h-5 text-emerald-600\" />\n                </div>\n                <div className=\"text-3xl font-bold text-emerald-700 mb-1\">{getBooksByStatus('READ').length}</div>\n                <div className=\"text-sm font-medium text-emerald-600\">Books Read</div>\n              </div>\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-100\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <FiBook className=\"w-5 h-5 text-blue-600\" />\n                </div>\n                <div className=\"text-3xl font-bold text-blue-700 mb-1\">{getBooksByStatus('CURRENTLY_READING').length}</div>\n                <div className=\"text-sm font-medium text-blue-600\">Currently Reading</div>\n              </div>\n              <div className=\"bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-100\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <FiStar className=\"w-5 h-5 text-amber-600\" />\n                </div>\n                <div className=\"text-3xl font-bold text-amber-700 mb-1\">{getBooksByStatus('WANT_TO_READ').length}</div>\n                <div className=\"text-sm font-medium text-amber-600\">Want to Read</div>\n              </div>\n            </div>\n\n            {/* Bio Section */}\n            <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <h3 className=\"text-base font-semibold text-gray-900\">About</h3>\n                {!isEditing && (\n                  <button\n                    onClick={() => setIsEditing(true)}\n                    className=\"text-gray-400 hover:text-teal-600 transition-colors p-1 rounded hover:bg-white\"\n                    aria-label=\"Edit bio\"\n                  >\n                    <FiEdit2 className=\"w-3.5 h-3.5\" />\n                  </button>\n                )}\n              </div>\n              {isEditing ? (\n                <div>\n                  <textarea\n                    value={editBio}\n                    onChange={(e) => setEditBio(e.target.value)}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none bg-white text-gray-900\"\n                    rows={3}\n                    placeholder=\"Tell us about yourself...\"\n                  />\n                  <div className=\"mt-3 flex gap-2\">\n                    <button\n                      onClick={updateBio}\n                      className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium\"\n                    >\n                      Save\n                    </button>\n                    <button\n                      onClick={() => {\n                        setIsEditing(false);\n                        setEditBio(profile?.bio || '');\n                      }}\n                      className=\"px-4 py-2 bg-white text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium border border-gray-200\"\n                    >\n                      Cancel\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <p className=\"text-gray-700 leading-relaxed text-sm\">\n                  {profile?.bio || 'No bio yet. Click the edit button to add one!'}\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Reading Goal Section */}\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center\">\n              <Target className=\"w-6 h-6 text-teal-600 mr-2\" />\n              <h2 className=\"text-lg font-semibold text-gray-900\">{new Date().getFullYear()} Reading Goal</h2>\n            </div>\n            {!isEditingGoal && (\n              <button\n                onClick={() => setIsEditingGoal(true)}\n                className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n              >\n                <FiEdit2 className=\"w-4 h-4\" />\n              </button>\n            )}\n          </div>\n\n          {isEditingGoal ? (\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Books Goal\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"365\"\n                  value={editGoalCount}\n                  onChange={(e) => setEditGoalCount(parseInt(e.target.value) || 0)}\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-gray-900\"\n                />\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={updateReadingGoal}\n                  className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium\"\n                >\n                  Save Goal\n                </button>\n                <button\n                  onClick={() => {\n                    setIsEditingGoal(false);\n                    if (readingGoal) {\n                      setEditGoalCount(readingGoal.goal_count);\n                    }\n                  }}\n                  className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div className=\"bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg p-4\">\n                <div className=\"text-3xl font-bold text-teal-600\">{editGoalCount}</div>\n                <div className=\"text-sm text-teal-700 mt-1\">Books Goal</div>\n              </div>\n              <div className=\"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4\">\n                <div className=\"text-3xl font-bold text-blue-600\">{booksReadThisYear}</div>\n                <div className=\"text-sm text-blue-700 mt-1\">Read This Year</div>\n              </div>\n              <div className=\"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4\">\n                <div className=\"text-3xl font-bold text-purple-600\">{Math.round((booksReadThisYear / editGoalCount) * 100)}%</div>\n                <div className=\"text-sm text-purple-700 mt-1\">Progress</div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Reading Lists */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Currently Reading */}\n          <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n              <FiBook className=\"w-5 h-5 mr-2 text-teal-600\" />\n              Currently Reading\n            </h2>\n            <div className=\"space-y-3\">\n              {getBooksByStatus('CURRENTLY_READING').map((userBook) => (\n                <div key={userBook.id} className=\"flex items-center space-x-3\">\n                  <img\n                    src={(userBook.books as any)?.cover_url || '/placeholder-book.png'}\n                    alt={(userBook.books as any)?.title}\n                    className=\"w-12 h-16 object-cover rounded\"\n                  />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium text-gray-900 truncate\">\n                      {(userBook.books as any)?.title}\n                    </p>\n                    <p className=\"text-sm text-gray-600\">{(userBook.books as any)?.author}</p>\n                  </div>\n                </div>\n              ))}\n              {getBooksByStatus('CURRENTLY_READING').length === 0 && (\n                <div className=\"text-center py-8\">\n                  <div className=\"inline-flex items-center justify-center w-12 h-12 bg-teal-50 rounded-full mb-3\">\n                    <FiBook className=\"w-6 h-6 text-teal-600\" />\n                  </div>\n                  <p className=\"text-gray-500 text-sm mb-3\">No books in progress</p>\n                  <Link href=\"/search\" className=\"inline-block px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors\">\n                    Start Reading\n                  </Link>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Want to Read */}\n          <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n              <FiStar className=\"w-5 h-5 mr-2 text-yellow-600\" />\n              Want to Read\n            </h2>\n            <div className=\"space-y-3\">\n              {getBooksByStatus('WANT_TO_READ').slice(0, 5).map((userBook) => (\n                <div key={userBook.id} className=\"flex items-center space-x-3\">\n                  <img\n                    src={(userBook.books as any)?.cover_url || '/placeholder-book.png'}\n                    alt={(userBook.books as any)?.title}\n                    className=\"w-12 h-16 object-cover rounded\"\n                  />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium text-gray-900 truncate\">\n                      {(userBook.books as any)?.title}\n                    </p>\n                    <p className=\"text-sm text-gray-600\">{(userBook.books as any)?.author}</p>\n                  </div>\n                </div>\n              ))}\n              {getBooksByStatus('WANT_TO_READ').length === 0 && (\n                <div className=\"text-center py-8\">\n                  <div className=\"inline-flex items-center justify-center w-12 h-12 bg-yellow-50 rounded-full mb-3\">\n                    <FiStar className=\"w-6 h-6 text-yellow-600\" />\n                  </div>\n                  <p className=\"text-gray-500 text-sm mb-3\">No books on your wishlist</p>\n                  <Link href=\"/search\" className=\"inline-block px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 transition-colors\">\n                    Discover Books\n                  </Link>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Recently Read */}\n          <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n              <FiBook className=\"w-5 h-5 mr-2 text-green-600\" />\n              Recently Read\n            </h2>\n            <div className=\"space-y-3\">\n              {getBooksByStatus('READ').slice(0, 5).map((userBook) => (\n                <div key={userBook.id} className=\"flex items-center space-x-3\">\n                  <img\n                    src={(userBook.books as any)?.cover_url || '/placeholder-book.png'}\n                    alt={(userBook.books as any)?.title}\n                    className=\"w-12 h-16 object-cover rounded\"\n                  />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium text-gray-900 truncate\">\n                      {(userBook.books as any)?.title}\n                    </p>\n                    <p className=\"text-sm text-gray-600\">{(userBook.books as any)?.author}</p>\n                  </div>\n                </div>\n              ))}\n              {getBooksByStatus('READ').length === 0 && (\n                <p className=\"text-gray-500 text-sm\">No books read yet</p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}