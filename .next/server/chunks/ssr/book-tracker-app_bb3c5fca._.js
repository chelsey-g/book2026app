module.exports=[2166,a=>{"use strict";let b=(0,a.i(59129).default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);a.s(["Loader",()=>b],2166)},49541,a=>{"use strict";let b=(0,a.i(59129).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],49541)},41782,a=>{"use strict";let b=(0,a.i(59129).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],41782)},39025,a=>{"use strict";var b=a.i(86531),c=a.i(52715),d=a.i(14366),e=a.i(75662),f=a.i(49541);let g=(0,a.i(59129).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var h=a.i(41782),i=a.i(2166),j=a.i(20607);function k(){let{user:k}=(0,d.useAuth)(),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(new Date().getFullYear());if(!k)return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(j.BookOpen,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sign In Required"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Sign in to import books from your Notion database"}),(0,b.jsx)(e.default,{href:"/auth/signin",className:"px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374]",children:"Sign In"})]})});let x=async a=>{let b=a.target.files?.[0];if(b){m(b),q(!0);try{let a=await b.text(),c=z(a).map((a,b)=>({...a,id:`book-${b}`,selected:!0,searchStatus:"pending"}));o(c),await A(c)}catch(a){console.error("Error parsing CSV:",a),alert("Error parsing CSV file. Please ensure it's exported from Notion.")}finally{q(!1)}}},y=a=>{let b=[],c="",d=!1;for(let e=0;e<a.length;e++){let f=a[e];'"'===f?d=!d:","!==f||d?c+=f:(b.push(c),c="")}return b.push(c),b},z=a=>{let b=a.split("\n"),c=y(b[0]).map(a=>a.trim().toLowerCase()),d=[];for(let a=1;a<b.length;a++){if(!b[a].trim())continue;let e=y(b[a]).map(a=>a.trim()),f={name:"",author:"",status:"READ",rating:0};c.forEach((a,b)=>{let c=e[b];if(a.includes("name")||a.includes("title"))f.name=c;else if(a.includes("author"))f.author=c;else if(a.includes("status"))f.status=({finished:"READ","currently reading":"CURRENTLY_READING","want to read":"WANT_TO_READ","did not finish":"DNF"})[c.toLowerCase()]||"READ";else if(a.includes("score")||a.includes("rating")){let a=(c.match(/â­/g)||[]).length;f.rating=a>0?a:0}else a.includes("date sta")?f.dateStarted=c:a.includes("date fin")?f.dateFinished=c:a.includes("type")&&(f.type=c)}),f.name&&f.author&&d.push(f)}return d},A=async a=>{u(!0);let b=[...a];for(let a=0;a<b.length;a++){try{let c=await fetch(`/api/books/search?q=${encodeURIComponent(b[a].name)} ${encodeURIComponent(b[a].author)}&limit=1`),d=await c.json();if(d.books&&d.books.length>0){let c=d.books[0];b[a].coverUrl=c.cover_url||c.coverUrl,b[a].description=c.description,b[a].searchStatus="found"}else b[a].searchStatus="not-found"}catch(c){console.error(`Error searching for ${b[a].name}:`,c),b[a].searchStatus="not-found"}o([...b])}u(!1)},B=a=>{o(n.map(b=>({...b,selected:a})))},C=async()=>{let b=n.filter(a=>a.selected);if(0===b.length)return void alert("Please select at least one book to import");s(!0);try{let{supabase:c}=await a.A(26406),{data:{session:d}}=await c.auth.getSession();if(!d?.access_token)throw Error("Authentication required");let e=b.map(a=>({name:a.name,author:a.author,status:a.status,rating:a.rating,dateStarted:a.dateStarted,dateFinished:a.dateFinished,type:a.type,cover:a.coverUrl,year:v}));console.log("ðŸ“¤ Sending books to import:",e),console.log("ðŸ“¤ Auth token:",d.access_token?.slice(0,20)+"...");let f=await fetch("/api/books/bulk-import",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d.access_token}`},body:JSON.stringify(e)}),g=await f.json();if(console.log("ðŸ“¥ Response:",{status:f.status,data:g}),!f.ok)throw Error(g.error||`API Error: ${f.status}`);let h=g.errors?.length>0?`

Failed: ${g.errors.map(a=>`${a.book}: ${a.error}`).join("\n")}`:"";alert(`Successfully imported ${g.importedCount} books!${h}`),o([]),m(null)}catch(a){console.error("âŒ Import error:",a),alert(`Import failed: ${a instanceof Error?a.message:"Unknown error"}`)}finally{s(!1)}},D=n.filter(a=>a.selected).length,E=n.filter(a=>"found"===a.searchStatus).length;return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Import Books from Notion"}),(0,b.jsx)("p",{className:"text-lg text-gray-600",children:"Upload your Notion CSV export to quickly add books to your library"})]}),0===n.length?(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-50 rounded-full mb-4",children:(0,b.jsx)(f.Upload,{className:"w-8 h-8 text-blue-600"})}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Upload Notion CSV"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"Export your reading list from Notion as CSV and upload it here. We'll match each book with cover art and let you review before importing."}),(0,b.jsxs)("label",{className:"inline-block",children:[(0,b.jsx)("input",{type:"file",accept:".csv",onChange:x,className:"hidden",disabled:p}),(0,b.jsx)("span",{className:"inline-flex items-center gap-2 px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374] cursor-pointer transition-colors font-medium",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Upload,{className:"w-5 h-5"}),"Choose CSV File"]})})]}),(0,b.jsxs)("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[(0,b.jsx)("p",{className:"text-sm text-blue-900 font-medium mb-3",children:"ðŸ“‹ How to export from Notion:"}),(0,b.jsxs)("ol",{className:"text-sm text-blue-800 space-y-2 text-left max-w-md mx-auto",children:[(0,b.jsx)("li",{children:"1. Open your Notion database"}),(0,b.jsx)("li",{children:"2. Click the â‹¯ menu (top right)"}),(0,b.jsx)("li",{children:'3. Select "Download" â†’ "Markdown & CSV"'}),(0,b.jsx)("li",{children:"4. Upload the CSV file here"})]})]})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:[n.length," books found"]}),(0,b.jsxs)("p",{className:"text-gray-600",children:[E," with cover art â€¢ ",D," selected"]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>B(!0),className:"px-4 py-2 text-sm font-medium text-[#018283] border border-[#018283] rounded-lg hover:bg-[#018283]/5",children:"Select All"}),(0,b.jsx)("button",{onClick:()=>B(!1),className:"px-4 py-2 text-sm font-medium text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Deselect All"})]})]}),(0,b.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Reading Year"}),(0,b.jsx)("select",{value:v,onChange:a=>w(parseInt(a.target.value)),className:"w-full sm:w-48 px-4 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-[#018283] focus:border-transparent bg-white",children:Array.from({length:10},(a,c)=>{let d=new Date().getFullYear()-c;return(0,b.jsx)("option",{value:d,children:d},d)})}),(0,b.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Select the year when you read these books. Dates without years will use this year."})]}),t&&(0,b.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-2 text-blue-900",children:[(0,b.jsx)(i.Loader,{className:"w-4 h-4 animate-spin"}),"Searching for cover art..."]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(a=>(0,b.jsx)("div",{onClick:()=>{var b;return b=a.id,void o(n.map(a=>a.id===b?{...a,selected:!a.selected}:a))},className:`rounded-lg border-2 p-4 cursor-pointer transition-all ${a.selected?"border-[#018283] bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-16",children:a.coverUrl?(0,b.jsx)("img",{src:a.coverUrl,alt:a.name,className:"w-16 h-24 object-cover rounded"}):(0,b.jsx)("div",{className:"w-16 h-24 bg-gray-200 rounded flex items-center justify-center",children:(0,b.jsx)(j.BookOpen,{className:"w-6 h-6 text-gray-400"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 truncate text-sm",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.author})]}),(0,b.jsx)("div",{className:"flex-shrink-0",children:"found"===a.searchStatus?(0,b.jsx)(g,{className:"w-5 h-5 text-green-500"}):"not-found"===a.searchStatus?(0,b.jsx)(h.XCircle,{className:"w-5 h-5 text-gray-300"}):(0,b.jsx)(i.Loader,{className:"w-5 h-5 animate-spin text-gray-400"})})]}),(0,b.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,b.jsxs)("div",{className:"flex gap-2 text-xs",children:[(0,b.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded",children:"READ"===a.status?"Read":"CURRENTLY_READING"===a.status?"Reading":"WANT_TO_READ"===a.status?"Want to Read":"DNF"}),a.rating>0&&(0,b.jsxs)("span",{className:"px-2 py-1 bg-yellow-100 rounded flex items-center gap-1",children:["â­ ",a.rating]})]}),a.dateFinished&&(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Finished: ",a.dateFinished]})]})]})]})},a.id))}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>{o([]),m(null)},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:"Cancel"}),(0,b.jsx)("button",{onClick:C,disabled:r||0===D,className:"flex-1 px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374] disabled:bg-gray-400 disabled:cursor-not-allowed font-medium",children:r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader,{className:"w-5 h-5 animate-spin inline mr-2"}),"Importing..."]}):`Import ${D} Books`})]})]})]})})}a.s(["default",()=>k],39025)},26406,a=>{a.v(a=>Promise.resolve().then(()=>a(1791)))}];

//# sourceMappingURL=book-tracker-app_bb3c5fca._.js.map