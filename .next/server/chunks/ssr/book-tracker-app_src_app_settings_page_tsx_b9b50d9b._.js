module.exports=[29476,a=>{"use strict";var b=a.i(86531),c=a.i(52715),d=a.i(14366),e=a.i(91635),f=a.i(75662),g=a.i(59129);let h=(0,g.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),i=(0,g.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),j=(0,g.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var k=a.i(21437),l=a.i(88940);function m(){let{user:g,loading:m,signOut:n}=(0,d.useAuth)(),{currentTheme:o,setTheme:p}=(0,e.useTheme)(),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)({current:!1,new:!1,confirm:!1}),[E,F]=(0,c.useState)({newEmail:""}),[G,H]=(0,c.useState)({}),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=localStorage.getItem("emailNotifications");null!==a&&r("true"===a)},[]),(0,c.useEffect)(()=>{m||g||(window.location.href="/")},[g,m]);let M=async()=>{confirm("Are you sure you want to sign out?")&&await n()},N=async b=>{let c;if(b.preventDefault(),B(!0),z(!1),x({}),c={},u.username||u.newPassword?(u.username&&u.username.length<3&&(c.username="Username must be at least 3 characters"),u.newPassword&&(u.newPassword.length<6&&(c.newPassword="Password must be at least 6 characters"),u.newPassword!==u.confirmPassword&&(c.confirmPassword="Passwords do not match"),u.currentPassword||(c.currentPassword="Current password required to change password")),x(c),0!==Object.keys(c).length):(c.general="Please fill in at least one field",!0))return void B(!1);try{let{data:{session:b}}=await (await a.A(26406)).supabase.auth.getSession(),c=b?.access_token;if(!c){x({general:"Authentication error. Please sign in again."}),B(!1);return}let d=await fetch("/api/users/profile",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({username:u.username||void 0,currentPassword:u.currentPassword||void 0,newPassword:u.newPassword||void 0})}),e=await d.json();d.ok?(z(!0),v({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>z(!1),3e3)):x({general:e.error||"Failed to update account"})}catch(a){console.error("Account update error:",a),x({general:"An error occurred. Please try again."})}finally{B(!1)}},O=async b=>{if(b.preventDefault(),L(!0),J(!1),H({}),!E.newEmail){H({general:"Please enter a new email address"}),L(!1);return}if(!E.newEmail.includes("@")){H({general:"Invalid email address"}),L(!1);return}try{let{data:{session:b}}=await (await a.A(26406)).supabase.auth.getSession(),c=b?.access_token;if(!c){H({general:"Authentication error. Please sign in again."}),L(!1);return}let d=await fetch("/api/users/email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({newEmail:E.newEmail})}),e=await d.json();d.ok?(J(!0),F({newEmail:""}),setTimeout(()=>J(!1),3e3)):H({general:e.error||"Failed to update email"})}catch(a){console.error("Email change error:",a),H({general:"An error occurred. Please try again."})}finally{L(!1)}};return m?(0,b.jsx)("div",{className:`min-h-screen bg-gradient-to-br ${e.THEMES.light.bgGradient} flex items-center justify-center`,children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"animate-pulse",children:(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading..."})})})}):g?(0,b.jsx)("div",{className:`min-h-screen bg-gradient-to-br ${o.bgGradient}`,children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(f.default,{href:"/dashboard",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors mb-6",children:[(0,b.jsx)(h,{className:"h-4 w-4"}),"Back to Dashboard"]}),(0,b.jsx)("h1",{className:`text-4xl font-bold bg-gradient-to-r ${o.accentColor} bg-clip-text text-transparent mb-2`,children:"Settings"}),(0,b.jsx)("p",{className:"text-lg text-gray-600",children:"Customize your reading experience"})]}),(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50",style:{borderColor:"currentColor"},children:[(0,b.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Choose Theme"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Select a color scheme for your BookTracker experience"})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(e.THEMES).map(([a,c])=>(0,b.jsxs)("div",{onClick:()=>{p(a)},className:`relative cursor-pointer rounded-xl overflow-hidden border-2 transition-all hover:scale-105 ${o.name===c.name?"border-gray-900 shadow-xl":"border-gray-200 hover:border-gray-400"}`,children:[(0,b.jsxs)("div",{className:`h-32 bg-gradient-to-br ${c.bgGradient} relative overflow-hidden`,children:[o.name===c.name&&(0,b.jsx)("div",{className:"absolute top-3 right-3 w-8 h-8 bg-gray-900 rounded-full flex items-center justify-center",children:(0,b.jsx)(i,{className:"h-5 w-5 text-white"})}),(0,b.jsxs)("div",{className:"absolute inset-0 p-4 flex flex-col justify-between",children:[(0,b.jsx)("div",{className:`w-12 h-12 bg-gradient-to-br ${c.accentColor} rounded-lg opacity-80`}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${c.statCards.books} rounded opacity-60`}),(0,b.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${c.statCards.total} rounded opacity-60`}),(0,b.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${c.statCards.reading} rounded opacity-60`}),(0,b.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${c.statCards.rating} rounded opacity-60`})]})]})]}),(0,b.jsxs)("div",{className:"p-4 bg-white",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900 text-lg",children:c.label}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:c.description})]})]},a))})})]}),(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,b.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Preferences"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your notification and account settings"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between pb-6 border-b border-gray-200",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Email Notifications"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Receive updates about friend activity and recommendations"})]}),(0,b.jsx)("button",{onClick:()=>{var a;r(a=!q),localStorage.setItem("emailNotifications",a.toString()),t(!0),setTimeout(()=>t(!1),2e3)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${q?"bg-teal-600":"bg-gray-300"}`,children:(0,b.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${q?"translate-x-6":"translate-x-1"}`})})]}),s&&(0,b.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,b.jsx)(i,{className:"h-4 w-4"}),"Preferences saved"]}),(0,b.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sign Out"}),(0,b.jsx)("button",{onClick:M,className:"w-full px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors font-medium",children:"Sign Out"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,b.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Account Management"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Update your username and password"})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[w.general&&(0,b.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3 text-red-700 text-sm",children:[(0,b.jsx)(j,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),(0,b.jsx)("span",{children:w.general})]}),y&&(0,b.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,b.jsx)(i,{className:"h-4 w-4"}),"Account updated successfully"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Username"}),(0,b.jsx)("input",{type:"text",value:u.username,onChange:a=>{v({...u,username:a.target.value}),w.username&&x({...w,username:""})},placeholder:"New username (optional)",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all text-gray-900 ${w.username?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),w.username&&(0,b.jsx)("p",{className:"text-red-600 text-sm mt-1",children:w.username})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 mb-4",children:"Change Password"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Current Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:C.current?"text":"password",value:u.currentPassword,onChange:a=>{v({...u,currentPassword:a.target.value}),w.currentPassword&&x({...w,currentPassword:""})},placeholder:"Enter current password",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${w.currentPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,b.jsx)("button",{type:"button",onClick:()=>D({...C,current:!C.current}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:C.current?(0,b.jsx)(l.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(k.Eye,{className:"h-4 w-4"})})]}),w.currentPassword&&(0,b.jsx)("p",{className:"text-red-600 text-sm mt-1",children:w.currentPassword})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"New Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:C.new?"text":"password",value:u.newPassword,onChange:a=>{v({...u,newPassword:a.target.value}),w.newPassword&&x({...w,newPassword:""})},placeholder:"New password (min 6 characters)",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${w.newPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,b.jsx)("button",{type:"button",onClick:()=>D({...C,new:!C.new}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:C.new?(0,b.jsx)(l.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(k.Eye,{className:"h-4 w-4"})})]}),w.newPassword&&(0,b.jsx)("p",{className:"text-red-600 text-sm mt-1",children:w.newPassword})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Confirm New Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:C.confirm?"text":"password",value:u.confirmPassword,onChange:a=>{v({...u,confirmPassword:a.target.value}),w.confirmPassword&&x({...w,confirmPassword:""})},placeholder:"Confirm new password",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${w.confirmPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,b.jsx)("button",{type:"button",onClick:()=>D({...C,confirm:!C.confirm}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:C.confirm?(0,b.jsx)(l.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(k.Eye,{className:"h-4 w-4"})})]}),w.confirmPassword&&(0,b.jsx)("p",{className:"text-red-600 text-sm mt-1",children:w.confirmPassword})]})]})]}),(0,b.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,b.jsx)("button",{type:"submit",disabled:A,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:A?"Saving...":"Save Changes"}),(0,b.jsx)("button",{type:"button",onClick:()=>{v({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),x({})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"})]})]})})]}),(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,b.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Email Address"}),(0,b.jsxs)("p",{className:"text-gray-600 mt-1",children:["Update your email address (currently: ",g.email,")"]})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[G.general&&(0,b.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3 text-red-700 text-sm",children:[(0,b.jsx)(j,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),(0,b.jsx)("span",{children:G.general})]}),I&&(0,b.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,b.jsx)(i,{className:"h-4 w-4"}),"Confirmation email sent to your new email address"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"New Email Address"}),(0,b.jsx)("input",{type:"email",value:E.newEmail,onChange:a=>{F({newEmail:a.target.value}),G.general&&H({})},placeholder:"Enter new email address",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-gray-900"})]}),(0,b.jsxs)("div",{className:"pt-2 flex gap-3",children:[(0,b.jsx)("button",{type:"submit",disabled:K,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:K?"Sending...":"Update Email"}),(0,b.jsx)("button",{type:"button",onClick:()=>{F({newEmail:""}),H({})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"})]})]})})]})]})}):null}a.s(["default",()=>m],29476)}];

//# sourceMappingURL=book-tracker-app_src_app_settings_page_tsx_b9b50d9b._.js.map