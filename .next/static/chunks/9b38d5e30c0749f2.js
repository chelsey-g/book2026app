(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90118,e=>{"use strict";let t=(0,e.i(10770).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],90118)},18576,e=>{"use strict";let t=(0,e.i(10770).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],18576)},74031,e=>{"use strict";let t=(0,e.i(10770).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],74031)},99436,e=>{"use strict";let t=(0,e.i(10770).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],99436)},9463,e=>{"use strict";let t=(0,e.i(10770).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],9463)},5227,e=>{"use strict";var t=e.i(75219),a=e.i(20614),r=e.i(52655),s=e.i(41706),l=e.i(20299),o=e.i(44868),i=e.i(90118),n=e.i(10770);let d=(0,n.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var c=e.i(35132);let h=(0,n.default)("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),x=(0,n.default)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var u=e.i(74031),m=e.i(18576),g=e.i(99436),b=e.i(9463);function p(){let{user:e}=(0,r.useAuth)(),[n,p]=(0,a.useState)([]),[y,f]=(0,a.useState)([]),[N,j]=(0,a.useState)(!0),[k,v]=(0,a.useState)("WANT_TO_READ"),[w,C]=(0,a.useState)(""),[A,E]=(0,a.useState)("date-added"),[R,D]=(0,a.useState)(null),[_,T]=(0,a.useState)(null),S=[{id:"WANT_TO_READ",label:"Want to Read",color:"bg-blue-50"},{id:"CURRENTLY_READING",label:"Currently Reading",color:"bg-green-50"},{id:"READ",label:"Read",color:"bg-purple-50"},{id:"DNF",label:"Did Not Finish",color:"bg-red-50"}];(0,a.useEffect)(()=>{e&&L()},[e]),(0,a.useEffect)(()=>{M()},[n,k,w,A]);let L=async()=>{try{let{data:{session:e}}=await s.supabase.auth.getSession();if(!e?.access_token)throw Error("No authentication token available");let t=await fetch("/api/users/books",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw Error("Failed to fetch books");let a=await t.json();p(a.books||[])}catch(e){console.error("Error fetching user books:",e)}finally{j(!1)}},M=()=>{let e=n.filter(e=>e.status===k);w&&(e=e.filter(e=>e.books?.title?.toLowerCase().includes(w.toLowerCase())||e.books?.author?.toLowerCase().includes(w.toLowerCase()))),e.sort((e,t)=>"date-added"===A?new Date(t.created_at).getTime()-new Date(e.created_at).getTime():"title"===A?(e.books?.title||"").localeCompare(t.books?.title||""):"author"===A?(e.books?.author||"").localeCompare(t.books?.author||""):0),f(e)},B=async e=>{try{let{data:{session:t}}=await s.supabase.auth.getSession();if(!t?.access_token)throw Error("No authentication token available");if(!(await fetch(`/api/users/books/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t.access_token}`}})).ok)throw Error("Failed to delete book");p(n.filter(t=>t.id!==e))}catch(e){console.error("Error deleting book:",e),alert("Failed to delete book")}},F=async(e,t)=>{try{let{data:{session:a}}=await s.supabase.auth.getSession();if(!a?.access_token)throw Error("No authentication token available");let r=await fetch("/api/users/books/status",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`},body:JSON.stringify({userBookId:e,status:t})});if(!r.ok)throw Error("Failed to update book status");let l=await r.json();p(n.map(t=>t.id===e?l.book:t))}catch(e){console.error("Error updating book status:",e),alert("Failed to update book status")}},O=async(e,t)=>{try{let{data:{session:a}}=await s.supabase.auth.getSession();if(!a?.access_token)throw Error("No authentication token available");let r=await fetch("/api/users/books/rating",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`},body:JSON.stringify({userBookId:e,rating:t})});if(!r.ok)throw Error("Failed to update rating");let l=await r.json();p(n.map(t=>t.id===e?l.book:t))}catch(e){console.error("Error updating rating:",e),alert("Failed to update rating")}},z=S.map(e=>({...e,count:n.filter(t=>t.status===e.id).length})),$=({status:e})=>{switch(e){case"WANT_TO_READ":return(0,t.jsx)(h,{className:"w-4 h-4 text-blue-500"});case"CURRENTLY_READING":return(0,t.jsx)(m.Clock,{className:"w-4 h-4 text-emerald-500"});case"READ":return(0,t.jsx)(u.CheckCircle,{className:"w-4 h-4 text-purple-500"});case"DNF":return(0,t.jsx)(g.XCircle,{className:"w-4 h-4 text-red-500"});default:return(0,t.jsx)(x,{className:"w-4 h-4 text-gray-400"})}};return e?N?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin mb-4",children:(0,t.jsx)(o.BookOpen,{className:"w-12 h-12 text-[#018283]"})}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading your books..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"My Books"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage and organize your reading library"})]}),(0,t.jsxs)(l.default,{href:"/import-books",className:"inline-flex items-center gap-2 px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374] transition-colors self-start",children:[(0,t.jsx)(b.Upload,{className:"w-5 h-5"}),"Import from Notion"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:z.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-[#018283]",children:e.count}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e.label})]},e.id))}),(0,t.jsx)("div",{className:"flex space-x-4 mb-6 border-b border-gray-200",children:S.map(e=>(0,t.jsxs)("button",{onClick:()=>v(e.id),className:`px-4 py-3 font-medium border-b-2 transition-colors ${k===e.id?"border-[#018283] text-[#018283]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.label,(0,t.jsx)("span",{className:"ml-2 text-sm bg-gray-100 px-2 py-1 rounded-full",children:z.find(t=>t.id===e.id)?.count||0})]},e.id))}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(c.Search,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Search by title or author...",value:w,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#018283] focus:border-transparent text-gray-900"})]}),(0,t.jsxs)("select",{value:A,onChange:e=>E(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#018283] focus:border-transparent",children:[(0,t.jsx)("option",{value:"date-added",children:"Recently Added"}),(0,t.jsx)("option",{value:"title",children:"Title A-Z"}),(0,t.jsx)("option",{value:"author",children:"Author A-Z"})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200",children:y.length>0?(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Title"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Author"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Rating"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Date Started"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Date Finished"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:y.map((e,a)=>(0,t.jsxs)("tr",{className:`border-b border-gray-200 hover:bg-gray-50 transition-colors ${a%2==0?"bg-white":"bg-gray-50/50"}`,children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)(l.default,{href:`/books/${e.books?.isbn||e.book_id}`,className:"text-[#018283] hover:underline font-medium flex items-center gap-3",children:[e.books?.cover_url?(0,t.jsx)("img",{src:e.books.cover_url,alt:e.books.title,className:"w-8 h-12 object-cover rounded"}):(0,t.jsx)("div",{className:"w-8 h-12 bg-gray-200 rounded flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(o.BookOpen,{className:"w-4 h-4 text-gray-400"})}),(0,t.jsx)("span",{children:e.books?.title})]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-700",children:e.books?.author}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("div",{className:"flex items-center gap-1 cursor-pointer",onMouseEnter:()=>T(e.id),onMouseLeave:()=>T(null),children:(0,t.jsx)("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(a=>(0,t.jsx)(i.Star,{onClick:()=>O(e.id,a),className:`w-4 h-4 cursor-pointer transition-all ${_===e.id?a<=(e.rating||0)?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-300":a<=(e.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},a))})})}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-500 text-sm",children:e.started_at?new Date(e.started_at).toLocaleDateString():"-"}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-500 text-sm",children:e.completed_at?new Date(e.completed_at).toLocaleDateString():"-"}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-1 relative z-20",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>D(R===e.id?null:e.id),className:"flex items-center gap-1.5 px-3 py-2 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md hover:border-[#2CAED8] transition-all duration-200",children:[(0,t.jsx)($,{status:e.status}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(e=>{switch(e){case"WANT_TO_READ":return"Want to Read";case"CURRENTLY_READING":return"Reading";case"READ":return"Read";case"DNF":return"Did Not Finish";default:return e}})(e.status)}),(0,t.jsx)("svg",{className:`w-4 h-4 text-gray-400 transition-transform duration-200 flex-shrink-0 ${R===e.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),R===e.id&&(0,t.jsx)("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[{value:"WANT_TO_READ",label:"Want to Read",color:"text-blue-600",bgColor:"bg-blue-50"},{value:"CURRENTLY_READING",label:"Currently Reading",color:"text-emerald-600",bgColor:"bg-emerald-50"},{value:"READ",label:"Read",color:"text-purple-600",bgColor:"bg-purple-50"},{value:"DNF",label:"Did Not Finish",color:"text-red-600",bgColor:"bg-red-50"}].map(a=>(0,t.jsxs)("button",{onClick:()=>{F(e.id,a.value),D(null)},className:`w-full px-3 py-2 flex items-center gap-2 text-sm hover:bg-gray-50 transition-colors ${e.status===a.value?a.bgColor:""}`,children:[(0,t.jsx)($,{status:a.value}),(0,t.jsx)("span",{className:`font-medium ${e.status===a.value?a.color:"text-gray-700"}`,children:a.label}),e.status===a.value&&(0,t.jsx)(u.CheckCircle,{className:"w-4 h-4 text-[#018283] ml-auto"})]},a.value))})]}),(0,t.jsx)("button",{onClick:()=>B(e.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 group flex-shrink-0",title:"Delete book",children:(0,t.jsx)(d,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})})]})})]},e.id))})]})}):(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gray-100 rounded-full mb-6",children:(0,t.jsx)(o.BookOpen,{className:"w-10 h-10 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No books on this shelf yet"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4 max-w-sm mx-auto",children:"WANT_TO_READ"===k?"Start building your reading list by discovering books":"CURRENTLY_READING"===k?"Begin a book to add it to your currently reading shelf":"READ"===k?"Mark books as read to see them here":"Books you haven't finished will appear here"}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,t.jsx)(l.default,{href:"/discover",className:"px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374] transition-colors font-medium",children:"Discover Books"}),(0,t.jsx)(l.default,{href:"/import-books",className:"px-6 py-3 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Import from Notion"})]})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-teal-50/30 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.BookOpen,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Please sign in"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"You need to be signed in to view your books"}),(0,t.jsx)(l.default,{href:"/auth/signin",className:"px-6 py-3 bg-[#018283] text-white rounded-lg hover:bg-[#017374] transition-colors",children:"Sign In"})]})})}e.s(["default",()=>p],5227)}]);