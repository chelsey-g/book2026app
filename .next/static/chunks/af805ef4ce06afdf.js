(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5331,35793,e=>{"use strict";var r=e.i(10770);let s=(0,r.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],5331);let a=(0,r.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["EyeOff",()=>a],35793)},96967,e=>{"use strict";var r=e.i(75219),s=e.i(20614),a=e.i(52655),t=e.i(97248),n=e.i(20299),l=e.i(10770);let o=(0,l.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),d=(0,l.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),i=(0,l.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var c=e.i(5331),m=e.i(35793);function u(){let{user:l,loading:u,signOut:x}=(0,a.useAuth)(),{currentTheme:g,setTheme:h}=(0,t.useTheme)(),[b,p]=(0,s.useState)(!0),[y,w]=(0,s.useState)(!1),[f,j]=(0,s.useState)({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),[N,v]=(0,s.useState)({}),[P,k]=(0,s.useState)(!1),[C,S]=(0,s.useState)(!1),[E,A]=(0,s.useState)({current:!1,new:!1,confirm:!1}),[$,T]=(0,s.useState)({newEmail:""}),[O,M]=(0,s.useState)({}),[U,B]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=localStorage.getItem("emailNotifications");null!==e&&p("true"===e)},[]),(0,s.useEffect)(()=>{u||l||(window.location.href="/")},[l,u]);let D=async()=>{confirm("Are you sure you want to sign out?")&&await x()},G=async r=>{let s;if(r.preventDefault(),S(!0),k(!1),v({}),s={},f.username||f.newPassword?(f.username&&f.username.length<3&&(s.username="Username must be at least 3 characters"),f.newPassword&&(f.newPassword.length<6&&(s.newPassword="Password must be at least 6 characters"),f.newPassword!==f.confirmPassword&&(s.confirmPassword="Passwords do not match"),f.currentPassword||(s.currentPassword="Current password required to change password")),v(s),0!==Object.keys(s).length):(s.general="Please fill in at least one field",!0))return void S(!1);try{let{data:{session:r}}=await (await e.A(38564)).supabase.auth.getSession(),s=r?.access_token;if(!s){v({general:"Authentication error. Please sign in again."}),S(!1);return}let a=await fetch("/api/users/profile",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({username:f.username||void 0,currentPassword:f.currentPassword||void 0,newPassword:f.newPassword||void 0})}),t=await a.json();a.ok?(k(!0),j({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>k(!1),3e3)):v({general:t.error||"Failed to update account"})}catch(e){console.error("Account update error:",e),v({general:"An error occurred. Please try again."})}finally{S(!1)}},I=async r=>{if(r.preventDefault(),H(!0),B(!1),M({}),!$.newEmail){M({general:"Please enter a new email address"}),H(!1);return}if(!$.newEmail.includes("@")){M({general:"Invalid email address"}),H(!1);return}try{let{data:{session:r}}=await (await e.A(38564)).supabase.auth.getSession(),s=r?.access_token;if(!s){M({general:"Authentication error. Please sign in again."}),H(!1);return}let a=await fetch("/api/users/email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({newEmail:$.newEmail})}),t=await a.json();a.ok?(B(!0),T({newEmail:""}),setTimeout(()=>B(!1),3e3)):M({general:t.error||"Failed to update email"})}catch(e){console.error("Email change error:",e),M({general:"An error occurred. Please try again."})}finally{H(!1)}};return u?(0,r.jsx)("div",{className:`min-h-screen bg-gradient-to-br ${t.THEMES.light.bgGradient} flex items-center justify-center`,children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("div",{className:"animate-pulse",children:(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading..."})})})}):l?(0,r.jsx)("div",{className:`min-h-screen bg-gradient-to-br ${g.bgGradient}`,children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(n.default,{href:"/dashboard",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors mb-6",children:[(0,r.jsx)(o,{className:"h-4 w-4"}),"Back to Dashboard"]}),(0,r.jsx)("h1",{className:`text-4xl font-bold bg-gradient-to-r ${g.accentColor} bg-clip-text text-transparent mb-2`,children:"Settings"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"Customize your reading experience"})]}),(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50",style:{borderColor:"currentColor"},children:[(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Choose Theme"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Select a color scheme for your BookTracker experience"})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(t.THEMES).map(([e,s])=>(0,r.jsxs)("div",{onClick:()=>{h(e)},className:`relative cursor-pointer rounded-xl overflow-hidden border-2 transition-all hover:scale-105 ${g.name===s.name?"border-gray-900 shadow-xl":"border-gray-200 hover:border-gray-400"}`,children:[(0,r.jsxs)("div",{className:`h-32 bg-gradient-to-br ${s.bgGradient} relative overflow-hidden`,children:[g.name===s.name&&(0,r.jsx)("div",{className:"absolute top-3 right-3 w-8 h-8 bg-gray-900 rounded-full flex items-center justify-center",children:(0,r.jsx)(d,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("div",{className:"absolute inset-0 p-4 flex flex-col justify-between",children:[(0,r.jsx)("div",{className:`w-12 h-12 bg-gradient-to-br ${s.accentColor} rounded-lg opacity-80`}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${s.statCards.books} rounded opacity-60`}),(0,r.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${s.statCards.total} rounded opacity-60`}),(0,r.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${s.statCards.reading} rounded opacity-60`}),(0,r.jsx)("div",{className:`w-8 h-8 bg-gradient-to-br ${s.statCards.rating} rounded opacity-60`})]})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-white",children:[(0,r.jsx)("h3",{className:"font-bold text-gray-900 text-lg",children:s.label}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]})]},e))})})]}),(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Preferences"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your notification and account settings"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between pb-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:"Email Notifications"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Receive updates about friend activity and recommendations"})]}),(0,r.jsx)("button",{onClick:()=>{var e;p(e=!b),localStorage.setItem("emailNotifications",e.toString()),w(!0),setTimeout(()=>w(!1),2e3)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${b?"bg-teal-600":"bg-gray-300"}`,children:(0,r.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${b?"translate-x-6":"translate-x-1"}`})})]}),y&&(0,r.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,r.jsx)(d,{className:"h-4 w-4"}),"Preferences saved"]}),(0,r.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sign Out"}),(0,r.jsx)("button",{onClick:D,className:"w-full px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors font-medium",children:"Sign Out"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Account Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Update your username and password"})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[N.general&&(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3 text-red-700 text-sm",children:[(0,r.jsx)(i,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{children:N.general})]}),P&&(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,r.jsx)(d,{className:"h-4 w-4"}),"Account updated successfully"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Username"}),(0,r.jsx)("input",{type:"text",value:f.username,onChange:e=>{j({...f,username:e.target.value}),N.username&&v({...N,username:""})},placeholder:"New username (optional)",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all text-gray-900 ${N.username?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),N.username&&(0,r.jsx)("p",{className:"text-red-600 text-sm mt-1",children:N.username})]}),(0,r.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 mb-4",children:"Change Password"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Current Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:E.current?"text":"password",value:f.currentPassword,onChange:e=>{j({...f,currentPassword:e.target.value}),N.currentPassword&&v({...N,currentPassword:""})},placeholder:"Enter current password",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${N.currentPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,r.jsx)("button",{type:"button",onClick:()=>A({...E,current:!E.current}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:E.current?(0,r.jsx)(m.EyeOff,{className:"h-4 w-4"}):(0,r.jsx)(c.Eye,{className:"h-4 w-4"})})]}),N.currentPassword&&(0,r.jsx)("p",{className:"text-red-600 text-sm mt-1",children:N.currentPassword})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:E.new?"text":"password",value:f.newPassword,onChange:e=>{j({...f,newPassword:e.target.value}),N.newPassword&&v({...N,newPassword:""})},placeholder:"New password (min 6 characters)",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${N.newPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,r.jsx)("button",{type:"button",onClick:()=>A({...E,new:!E.new}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:E.new?(0,r.jsx)(m.EyeOff,{className:"h-4 w-4"}):(0,r.jsx)(c.Eye,{className:"h-4 w-4"})})]}),N.newPassword&&(0,r.jsx)("p",{className:"text-red-600 text-sm mt-1",children:N.newPassword})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Confirm New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:E.confirm?"text":"password",value:f.confirmPassword,onChange:e=>{j({...f,confirmPassword:e.target.value}),N.confirmPassword&&v({...N,confirmPassword:""})},placeholder:"Confirm new password",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all pr-10 text-gray-900 ${N.confirmPassword?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`}),(0,r.jsx)("button",{type:"button",onClick:()=>A({...E,confirm:!E.confirm}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:E.confirm?(0,r.jsx)(m.EyeOff,{className:"h-4 w-4"}):(0,r.jsx)(c.Eye,{className:"h-4 w-4"})})]}),N.confirmPassword&&(0,r.jsx)("p",{className:"text-red-600 text-sm mt-1",children:N.confirmPassword})]})]})]}),(0,r.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,r.jsx)("button",{type:"submit",disabled:C,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:C?"Saving...":"Save Changes"}),(0,r.jsx)("button",{type:"button",onClick:()=>{j({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),v({})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg overflow-hidden border border-opacity-50 mt-6",style:{borderColor:"currentColor"},children:[(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Email Address"}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:["Update your email address (currently: ",l.email,")"]})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[O.general&&(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3 text-red-700 text-sm",children:[(0,r.jsx)(i,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{children:O.general})]}),U&&(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700 text-sm",children:[(0,r.jsx)(d,{className:"h-4 w-4"}),"Confirmation email sent to your new email address"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"New Email Address"}),(0,r.jsx)("input",{type:"email",value:$.newEmail,onChange:e=>{T({newEmail:e.target.value}),O.general&&M({})},placeholder:"Enter new email address",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-gray-900"})]}),(0,r.jsxs)("div",{className:"pt-2 flex gap-3",children:[(0,r.jsx)("button",{type:"submit",disabled:z,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:z?"Sending...":"Update Email"}),(0,r.jsx)("button",{type:"button",onClick:()=>{T({newEmail:""}),M({})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"})]})]})})]})]})}):null}e.s(["default",()=>u],96967)},38564,e=>{e.v(e=>Promise.resolve().then(()=>e(41706)))}]);