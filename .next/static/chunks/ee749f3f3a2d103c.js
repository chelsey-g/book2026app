(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90118,e=>{"use strict";let t=(0,e.i(10770).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],90118)},57314,e=>{"use strict";let t=(0,e.i(10770).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],57314)},74031,e=>{"use strict";let t=(0,e.i(10770).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],74031)},56815,e=>{"use strict";var t=e.i(75219),s=e.i(20614),a=e.i(52655),r=e.i(44868),i=e.i(90118),l=e.i(57314),n=e.i(74031);function o({params:e}){let{user:o}=(0,a.useAuth)(),[c,d]=(0,s.useState)(null),[m,x]=(0,s.useState)(null),[h,u]=(0,s.useState)([]),[g,b]=(0,s.useState)([]),[p,f]=(0,s.useState)({rating:0,content:""}),[j,y]=(0,s.useState)(null),[v,w]=(0,s.useState)(!0),[N,k]=(0,s.useState)(0),[R,S]=(0,s.useState)("recent");(0,s.useEffect)(()=>{e.then(({id:e})=>{d(e)})},[e]),(0,s.useEffect)(()=>{c&&(E(),T())},[c]),(0,s.useEffect)(()=>{C()},[h,N,R]);let C=()=>{let e=h;N>0&&(e=e.filter(e=>e.rating>=N));let t=[...e];"highest"===R?t.sort((e,t)=>t.rating-e.rating):"lowest"===R?t.sort((e,t)=>e.rating-t.rating):t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),b(t)},E=async()=>{try{let e=await fetch(`/api/books/${c}`),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to fetch book details");if(x(t.book),o){let e=await fetch("/api/users/books"),t=(await e.json()).books.find(e=>e.books?.isbn===c||e.book_id===c);t&&y(t.status)}}catch(e){console.error("Error fetching book details:",e)}},T=async()=>{try{let e=await fetch(`/api/reviews?bookId=${c}`),t=await e.json();e.ok&&t.reviews&&u(t.reviews)}catch(e){console.error("Error fetching reviews:",e)}finally{w(!1)}},A=async e=>{if(!o)return void alert("Please sign in to add books to your list");if(!m)return void alert("Book information not loaded");try{let t=await fetch("/api/users/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:m.isbn||m.id,title:m.title,author:m.author,description:m.description,coverUrl:m.coverUrl,isbn:m.isbn,pageCount:m.pageCount,publishedDate:m.publishedDate,status:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to add book");y(e),alert(`Book added to ${e.toLowerCase().replace(/_/g," ")} list`)}catch(e){console.error("Error adding book:",e),alert("Failed to add book. Please try again.")}},D=async e=>{if(e.preventDefault(),!o)return void alert("Please sign in to submit a review");if(0===p.rating)return void alert("Please select a rating");if(!m)return void alert("Book information not loaded");try{let e=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:m.isbn||m.id,rating:p.rating,content:p.content})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to submit review");u([t.review,...h]),f({rating:0,content:""}),alert("Review submitted successfully!")}catch(e){console.error("Error submitting review:",e),alert("Failed to submit review. Please try again.")}};return v?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(r.BookOpen,{className:"h-12 w-12 text-indigo-600 mx-auto mb-4 animate-pulse"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading book details..."})]})}):m?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[m.coverUrl?(0,t.jsx)("img",{src:m.coverUrl,alt:m.title,className:"w-full max-w-md mx-auto rounded-lg shadow-lg"}):(0,t.jsx)("div",{className:"w-full max-w-md mx-auto bg-gray-200 rounded-lg shadow-lg flex items-center justify-center",children:(0,t.jsx)(r.BookOpen,{className:"h-24 w-24 text-gray-400"})}),o&&(0,t.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,t.jsxs)("button",{onClick:()=>A("WANT_TO_READ"),disabled:"WANT_TO_READ"===j,className:`w-full flex items-center justify-center space-x-2 py-3 rounded-md transition-colors ${"WANT_TO_READ"===j?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[(0,t.jsx)(l.Plus,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Want to Read"})]}),(0,t.jsxs)("button",{onClick:()=>A("CURRENTLY_READING"),disabled:"CURRENTLY_READING"===j,className:`w-full flex items-center justify-center space-x-2 py-3 rounded-md transition-colors ${"CURRENTLY_READING"===j?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:[(0,t.jsx)(n.CheckCircle,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Currently Reading"})]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:m.title}),(0,t.jsxs)("p",{className:"text-xl text-gray-600 mb-6",children:["by ",m.author]}),m.publishedDate&&(0,t.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:["Published: ",m.publishedDate]}),m.pageCount&&(0,t.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:[m.pageCount," pages"]}),m.description&&(0,t.jsx)("div",{className:"prose max-w-none mb-8",children:(0,t.jsx)("p",{children:m.description})}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Reviews"}),h.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(e=>(0,t.jsx)(i.Star,{className:`h-5 w-5 ${e<=Math.round(0===h.length?0:parseFloat((h.reduce((e,t)=>e+t.rating,0)/h.length).toFixed(1)))?"text-yellow-400 fill-current":"text-gray-300"}`},e))}),(0,t.jsxs)("span",{className:"text-gray-600",children:["(",h.length," reviews)"]})]})]})}),h.length>0&&(0,t.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Rating"}),(0,t.jsxs)("select",{value:N,onChange:e=>k(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,t.jsx)("option",{value:0,children:"All ratings"}),(0,t.jsx)("option",{value:5,children:"5 stars"}),(0,t.jsx)("option",{value:4,children:"4+ stars"}),(0,t.jsx)("option",{value:3,children:"3+ stars"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort by"}),(0,t.jsxs)("select",{value:R,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,t.jsx)("option",{value:"recent",children:"Most Recent"}),(0,t.jsx)("option",{value:"highest",children:"Highest Rated"}),(0,t.jsx)("option",{value:"lowest",children:"Lowest Rated"})]})]})]}),o&&(0,t.jsxs)("form",{onSubmit:D,className:"mb-8 bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Rating"}),(0,t.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,t.jsx)(i.Star,{className:`h-6 w-6 cursor-pointer transition-colors ${p.rating>=e?"text-yellow-400 fill-current":"text-gray-300"}`,onClick:()=>f(t=>({...t,rating:e}))},e))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"review-content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Review (Optional)"}),(0,t.jsx)("textarea",{id:"review-content",value:p.content,onChange:e=>f(t=>({...t,content:e.target.value})),placeholder:"Share your thoughts about this book",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-gray-900",rows:4})]}),(0,t.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Submit Review"})]}),0===g.length?(0,t.jsxs)("div",{className:"text-center bg-white rounded-lg shadow p-8",children:[(0,t.jsx)(i.Star,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:0===h.length?"No reviews yet. Be the first to review!":"No reviews match your filter."})]}):(0,t.jsx)("div",{className:"space-y-4",children:g.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"flex space-x-1 mr-4",children:[1,2,3,4,5].map(s=>(0,t.jsx)(i.Star,{className:`h-5 w-5 ${e.rating>=s?"text-yellow-400 fill-current":"text-gray-300"}`},s))}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]}),e.content&&(0,t.jsx)("p",{className:"text-gray-700 mb-4",children:e.content}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[e.user.image?(0,t.jsx)("img",{src:e.user.image,alt:e.user.name||"User",className:"w-8 h-8 rounded-full object-cover"}):(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-indigo-200 flex items-center justify-center text-indigo-600",children:e.user.name?.[0]||"U"}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.user.name||e.user.username||"Anonymous"})]})]},e.id))})]})]})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(r.BookOpen,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Book not found"})]})})}e.s(["default",()=>o])}]);